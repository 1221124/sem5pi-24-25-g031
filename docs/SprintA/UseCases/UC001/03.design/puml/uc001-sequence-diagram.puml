@startuml uc001-sequence-diagram

skinparam packageStyle rectangle
skinparam shadowing false
skinparam linetype polyline

skinparam classAttributeIconSize 0

title Sequence Diagram (SD) - UC001

participant ":UserController" as Controller
participant ":UserService" as Service
participant ":IUserRepository" as Repository <<interface>>
participant "user:User" as Domain
participant "dto:UserDto" as Dto

-> Controller: POST /api/user

activate Controller

    Controller -> Service: AddAsync(creatingUserDto)

    activate Service

        Service -> Service: ValidateUsernameAndEmail(email)

        Service -> Repository: GetByUsernameAsync(email)
        
        activate Repository

            Repository --> Service: user

        deactivate Repository

        Service -> Repository: GetByEmailAsync(email)
        
        activate Repository

            Repository --> Service: user

        deactivate Repository

        Service -> Domain: new User(email, role)

        activate Domain

            Domain --> Service: user

        deactivate Domain

        Service -> Repository: AddAsync(user)

        activate Repository

            Repository --> Service: user

        deactivate Repository

        Service -> Dto: new UserDto(user)

        activate Dto

            Dto --> Service: dto

        deactivate Dto

        Service --> Controller: dto

    deactivate Service

    <-- Controller :201 Created

deactivate Controller

@enduml
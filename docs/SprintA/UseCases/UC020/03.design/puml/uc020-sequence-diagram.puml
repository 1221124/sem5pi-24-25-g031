@startuml uc020-sequence-diagram

skinparam packageStyle rectangle
skinparam shadowing false
skinparam linetype polyline
skinparam classAttributeIconSize 0

title Sequence Diagram (SD) - UC020

actor Admin as Adm
participant "Postman (Client)" as Client
participant "OperationTypeController" as Controller
participant "OperationTypeService" as Service
participant "OperationType" as Domain
participant "OperationTypeRepository" as Repository
database "IOperationTypeRepository" as IRepo

activate Adm

    Adm -> Client: POST /api/operationtype

    activate Client

        Client -> Controller: POST /api/operationtype \n Body: {name, staffBySpecialization, phasesDuration}

        activate Controller

            Controller -> Service: registerOperationType(name, staffBySpecialization, phasesDuration)

            activate Service

                Service -> Service: validateOperationTypeName(name)

                Service -> Repository: GET /operationtypes/byname/{name}

                activate Repository

                    Repository --> Service: 404 Not Found (Operation Type with said name)

                deactivate Repository

                Service -> Domain: new OperationType(name, staffBySpecialization, phasesDuration)

                activate Domain

                    Domain --> Service: operationType

                deactivate Domain

                Service -> Repository: POST /operationtypes \n Body: {operationType}

                activate Repository

                    Repository -> IRepo: save(operationType)

                    activate IRepo

                        IRepo --> Repository: 201 Created (Operation Type successfully saved)

                    deactivate IRepo

                    Repository --> Service: Operation Type successfully saved

                deactivate Repository

                Service --> Controller: 201 Created (Operation Type successfully saved)

            deactivate Service

            Controller --> Client: 201 Created \n Body: {operationTypeId}

        deactivate Controller

        Client --> Adm: Operation Type successfully created with ID

    deactivate Client

deactivate Adm

@enduml

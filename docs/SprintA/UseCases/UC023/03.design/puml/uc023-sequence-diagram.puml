@startuml uc023-sequence-diagram

skinparam packageStyle rectangle
skinparam shadowing false
skinparam linetype polyline
skinparam classAttributeIconSize 0

title Sequence Diagram (SD) - UC023

participant "OperationTypeController" as Controller
participant "OperationTypeService" as Service
participant "OperationType" as Domain
participant "OperationTypeRepository" as Repository
participant "IOperationTypeRepository" as IRepo

-> Controller: GET /api/operationtype

activate Controller

    Controller -> Service: GetAll()

    activate Service

        Service -> Repository: GetAllAsync()

        activate Repository

            Repository -> IRepo: GetAllAsync()
            
            activate IRepo

                IRepo --> Repository: operationTypes

            deactivate IRepo

            Repository --> Service: operationTypes

        deactivate Repository

        Service -> Service: ValidateOperationTypeName(name)

        Service -> Repository: GetByNameAsync(name)

        activate Repository

            Repository -> IRepo: GetByNameAsync(name)
            
            activate IRepo

                IRepo --> Repository: null

            deactivate IRepo

            Repository --> Service: null

        deactivate Repository

        Service -> Domain: new OperationType(dto.getName(), dto.getSpecialization(), dto.getRequiredStaff(), dto.getPhasesDuration())

        activate Domain

            Domain --> Service: operationType

        deactivate Domain

        Service -> Repository: UpdateAsync(operationType)

        activate Repository

            Repository -> IRepo: UpdateAsync(operationType)

            activate IRepo

                IRepo --> Repository: dto

            deactivate IRepo

            Repository --> Service: dto

        deactivate Repository

        Service --> Controller: dto

    deactivate Service

    <-- Controller : dto

deactivate Controller

@enduml

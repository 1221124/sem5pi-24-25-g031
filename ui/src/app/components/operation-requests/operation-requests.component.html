<div class="operationRequests-request">
  <h1>Operation Request</h1>
  <button type="button" (click)="openCreateModal()">Create Operation Request</button>

  <!-- Create Modal -->
  <div *ngIf="isCreateModalOpen" class="modal">
    <div class="modal-content">
      <span type="button" class="close" (click)="closeCreateModal()">&times;</span>
      <h2>Operation Request Form</h2>
      
      <section>
        <form class="form-group">
          <!-- Staff Selection -->
          <div>
            <label for="staff">Select Staff:</label>
            <select id="staff" name="staff" [(ngModel)]="staff" (focus)="staffTouched = true">
              <option *ngFor="let staff of staffs" [value]="staff.licenseNumber">
                {{ staff.licenseNumber }} - {{ staff.email }}
              </option>
            </select>
          </div>
          
          <!-- Patient Selection -->
          <div>
            <label for="patient">Select Patient:</label>
            <select id="patient" name="patient" [(ngModel)]="patient" (focus)="patientTouched = true">
              <option *ngFor="let patient of patients" [value]="patient.medicalRecordNumber">
                {{ patient.medicalRecordNumber }} - {{ patient.email }}
              </option>
            </select>
          </div>

          <!-- Operation Type Selection -->
          <div>
            <label for="operationType">Select Operation Type:</label>
            <select id="operationType" name="operationType" [(ngModel)]="operationType" (focus)="operationTypeTouched = true">
              <option *ngFor="let operationType of operationTypes" [value]="operationType.Name">
                {{ operationType.Name }} - {{ operationType.Specialization }}
              </option>
            </select>
          </div>

          <!-- Date Selection -->
          <div>
            <label for="deadlineDate">Select Date:</label>
            <input type="date" id="deadlineDate" name="deadlineDate" [(ngModel)]="deadlineDate" (focus)="deadlineDateTouched = true" />
          </div>

          <!-- Priority Selection -->
          <div>
            <label for="priority">Select Priority:</label>
            <select id="priority" name="priority" [(ngModel)]="priority" (focus)="priorityTouched = true">
              <option *ngFor="let priority of priorities" [value]="priority">
                {{ priority }}
              </option>
            </select>
          </div>

          <div class="button-group">
            <button type="button" class="btn-create-request" (click)="openCreateModal()">Create Request</button>
          </div>
        </form>
      </section>
    </div>
  </div>

  <!-- Requests Table -->
  <div class="get-requests">
    <table>
      <thead>
        <tr>
          <th>Request</th>
          <th>Staff</th>
          <th>Patient</th>
          <th>Operation Type</th>
          <th>Deadline Date</th>  
          <th>Priority</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let request of requests">
          <td>{{ request.id }}</td>
          <td>{{ request.staff }}</td>
          <td>{{ request.patient }}</td>
          <td>{{ request.operationType }}</td>
          <td>{{ request.deadlineDate }}</td>
          <td>{{ request.priority }}</td>
          <td>{{ request.status }}</td>
          <td>
            <button type="button" class="btn-delete-request" (click)="openDeleteModal(request)">
              <i class="fas fa-edit"></i>Delete
            </button>

            <button type="button" class="btn-update-request" (click)="openUpdateModal(request)">
              <i class="fas fa-edit"></i>Update
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Delete Modal -->
  <div *ngIf="isDeleteModalOpen" class="modal">
    <div class="modal-content">
      <span class="close" (click)="closeDeleteModal()">&times;</span>
      <h2>Confirm Deletion</h2>
      <p>Are you sure you want to delete this request?</p>
      <div class="button-group">
        <button type="button" (click)="confirmDelete()">Confirm</button>
        <button type="button" (click)="closeDeleteModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Update Modal -->
  <div *ngIf="isUpdateModalOpen" class="modal">
    <div class="modal-content">
      <span class="close" (click)="closeUpdateModal()">&times;</span>
      <h2>Update Request</h2>
      <section>
        <form class="form-group">
          <!-- Date Selection -->
          <div>
            <label for="updateDeadlineDate">Select Date:</label>
            <input type="date" id="updateDeadlineDate" name="deadlineDate" [(ngModel)]="request.deadlineDate" (focus)="deadlineDateTouched = true" />
          </div>
  
          <!-- Priority Selection -->
          <div>
            <label for="updatePriority">Select Priority:</label>
            <select id="updatePriority" name="priority" [(ngModel)]="request.priority" (focus)="priorityTouched = true">
              <option *ngFor="let priority of priorities" [value]="priority">{{ priority }}</option>
            </select>
          </div>

          <!-- Status Selection -->
          <div>
            <label for="status">Select Status:</label>
            <select id="status" name="status" [(ngModel)]="request.status" (focus)="statusTouched = true">
              <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
            </select>
          </div>

          <div class="button-group">
            <button type="button" class="btn-update-request" (click)="confirmUpdate(request)">Update Request</button>
          </div>
        </form>
      </section>
    </div>
  </div>
</div>
